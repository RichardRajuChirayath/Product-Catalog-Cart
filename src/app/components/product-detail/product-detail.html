<div class="container detail-container">
    <div *ngIf="loading()" class="skeleton-detail">
        <div class="skeleton shimmer-effect" style="height: 500px; border-radius: 24px;"></div>
        <div class="detail-info-skeleton">
            <div class="skeleton shimmer-effect" style="width: 20%; height: 20px; margin-bottom: 24px;"></div>
            <div class="skeleton shimmer-effect" style="width: 80%; height: 48px; margin-bottom: 16px;"></div>
            <div class="skeleton shimmer-effect" style="width: 40%; height: 32px; margin-bottom: 40px;"></div>
            <div class="skeleton shimmer-effect" style="width: 100%; height: 200px; margin-bottom: 40px;"></div>
            <div class="skeleton shimmer-effect" style="width: 60%; height: 56px;"></div>
        </div>
    </div>

    <div *ngIf="error()" class="error-view">
        <mat-icon color="warn">error</mat-icon>
        <h2>Oops! Something went wrong</h2>
        <p>{{ error() }}</p>
        <button mat-raised-button color="primary" routerLink="/products">Back to Shop</button>
    </div>

    <div class="product-layout" *ngIf="!loading() && product() as p">
        <div class="media-column">
            <mat-card class="image-card">
                <img [src]="p.image" [alt]="p.title">
            </mat-card>
        </div>

        <div class="details-column">
            <nav class="breadcrumb">
                <span routerLink="/products">Products</span>
                <mat-icon>chevron_right</mat-icon>
                <span class="category-link">{{ p.category }}</span>
            </nav>

            <h1 class="product-title">{{ p.title }}</h1>

            <div class="meta-row">
                <div class="rating-badge" *ngIf="p.rating">
                    <mat-icon>star</mat-icon>
                    <span>{{ p.rating.rate }}</span>
                    <span class="count">({{ p.rating.count }} Reviews)</span>
                </div>
                <div class="stock-status">
                    <span class="status-dot"></span> In Stock
                </div>
            </div>

            <div class="price-section">
                <span class="main-price">{{ p.price | currency:'INR':'symbol':'1.2-2' }}</span>
                <span class="tax-info">+ Local taxes & shipping included</span>
            </div>

            <div class="description-section">
                <h3>OVERVIEW</h3>
                <p>{{ p.description }}</p>
            </div>

            <div class="purchase-actions">
                <button mat-raised-button color="primary" class="buy-btn" (click)="addToCart()">
                    <mat-icon>add_shopping_cart</mat-icon>
                    ADD TO CART
                </button>
                <button mat-button class="wishlist-btn-detail" (click)="toggleWishlist()"
                    [matTooltip]="wishlistService.isInWishlist(p.id) ? 'Remove from Favorites' : 'Add to Favorites'">
                    <mat-icon [class.active-heart]="wishlistService.isInWishlist(p.id)">
                        {{ wishlistService.isInWishlist(p.id) ? 'favorite' : 'favorite_border' }}
                    </mat-icon>
                </button>
            </div>

            <div class="features-grid">
                <div class="feature-item">
                    <mat-icon>local_shipping</mat-icon>
                    <span>Free Shipping</span>
                </div>
                <div class="feature-item">
                    <mat-icon>verified</mat-icon>
                    <span>Genuine Product</span>
                </div>
                <div class="feature-item">
                    <mat-icon>replay</mat-icon>
                    <span>30-Day Returns</span>
                </div>
            </div>
        </div>
    </div>
</div>